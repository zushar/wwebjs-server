{"version":3,"sources":["../../src/wwebjs/client-factory.service.ts"],"sourcesContent":["import { Injectable, Logger } from '@nestjs/common';\nimport { Client, ClientOptions, LocalAuth } from 'whatsapp-web.js';\n\n@Injectable()\nexport class ClientFactoryService {\n  private readonly logger = new Logger(ClientFactoryService.name);\n\n  /**\n   * Creates a new WhatsApp Web.js client with consistent configuration\n   * @param phoneNumber The phone number to associate with this client\n   * @returns A configured Client instance\n   */\n  createClient(phoneNumber: string): Client {\n    this.logger.debug(`Creating WhatsApp client for: ${phoneNumber}`);\n    const defaultOptions: ClientOptions = {\n      authStrategy: new LocalAuth({\n        clientId: phoneNumber,\n      }),\n      puppeteer: {\n        headless: true, // Set to false for debugging if needed\n        args: [\n          '--no-sandbox',\n          '--disable-setuid-sandbox',\n          '--disable-gpu',\n          '--disable-dev-shm-usage',\n          '--disable-accelerated-2d-canvas',\n          '--no-first-run',\n          '--no-zygote',\n          '--single-process',\n          '--disable-features=site-per-process',\n          '--window-size=1920,1080',\n          '--js-flags=\"--max-old-space-size=128\"', // Limit JS heap to 128MB per Chromium\n        ],\n      },\n    };\n\n    return new Client(defaultOptions);\n  }\n}\n"],"names":["ClientFactoryService","createClient","phoneNumber","logger","debug","defaultOptions","authStrategy","LocalAuth","clientId","puppeteer","headless","args","Client","Logger","name"],"mappings":";;;;+BAIaA;;;eAAAA;;;wBAJsB;6BACc;;;;;;;AAG1C,IAAA,AAAMA,uBAAN,MAAMA;IAGX;;;;GAIC,GACDC,aAAaC,WAAmB,EAAU;QACxC,IAAI,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,8BAA8B,EAAEF,aAAa;QAChE,MAAMG,iBAAgC;YACpCC,cAAc,IAAIC,sBAAS,CAAC;gBAC1BC,UAAUN;YACZ;YACAO,WAAW;gBACTC,UAAU;gBACVC,MAAM;oBACJ;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;iBACD;YACH;QACF;QAEA,OAAO,IAAIC,mBAAM,CAACP;IACpB;;aAhCiBF,SAAS,IAAIU,cAAM,CAACb,qBAAqBc,IAAI;;AAiChE"}